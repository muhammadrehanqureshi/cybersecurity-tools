import os

# Example malware signatures
MALWARE_SIGNATURES = [
    "e99a18c428cb38d5f260853678922e03",  # MD5 of "abc123"
    "d41d8cd98f00b204e9800998ecf8427e",  # MD5 of an empty string
]

def hash_file(filepath):
    """Calculate the MD5 hash of a file."""
    import hashlib
    hasher = hashlib.md5()
    try:
        with open(filepath, "rb") as f:
            while chunk := f.read(4096):
                hasher.update(chunk)
        return hasher.hexdigest()
    except (FileNotFoundError, PermissionError):
        return None

def scan_file(filepath):
    """Check if the file contains known malware signatures."""
    file_hash = hash_file(filepath)
    if file_hash and file_hash in MALWARE_SIGNATURES:
        return True
    return False

def scan_directory(directory):
    """Recursively scan all files in a directory."""
    results = []
    for root, _, files in os.walk(directory):
        for file in files:
            filepath = os.path.join(root, file)
            if scan_file(filepath):
                results.append(filepath)
    return results

if __name__ == "__main__":
    target_directory = input("Enter the directory to scan: ")

    print(f"Scanning directory: {target_directory}")
    infected_files = scan_directory(target_directory)

    if infected_files:
        print("\nPotential malware detected in the following files:")
        for file in infected_files:
            print(f"- {file}")
    else:
        print("\nNo malware detected.")
